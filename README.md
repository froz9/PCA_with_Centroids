# PCA_with_Centroids
## DESCRIPTION:
This script performs a Principal Component Analysis (PCA) on metabolomics data. It then calculates the centroids for predefined groups within the data and generates scatter plots of the principal components (PCs). These plots visualize the relationship between individual data points and their respective group centroids, helping to assess within-group cohesion and between-group separation.

### You need to download this code first
<img width="1493" height="641" alt="Screenshot 2025-09-07 073847" src="https://github.com/user-attachments/assets/b6d44762-cbc1-49fb-be87-e3749bcea95d" />

### Open in your preferred development environment
<img width="954" height="1010" alt="Screenshot 2025-09-07 074347" src="https://github.com/user-attachments/assets/1c0626ce-c8d4-47a9-bdcb-09b9e6d82109" />

### Your data is expected to be in a matrix-like format where rows are samples and columns are features (metabolites). A 'feature' or 'group' column should exist as the first one for sample classification.
<img width="1503" height="373" alt="Screenshot 2025-09-07 074643" src="https://github.com/user-attachments/assets/220eefb3-ff50-4210-bf50-e525e513f330" />

### Run the code as usual. The outputs will be the plots showing the samples as dots and the centroids as a bigger dot
<img width="671" height="342" alt="Rplot" src="https://github.com/user-attachments/assets/67bf4e00-75e9-44c7-aa85-783f010968ca" />

### The code generates three main plots, PC1 vs PC2, PC1 vs PC3, and PC2 vs PC3. You can add more projections if you need it

